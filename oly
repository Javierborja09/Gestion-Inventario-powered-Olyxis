#!/usr/bin/env php
<?php

$internalAutoloader = __DIR__ . '/vendor/autoload.php';
$currentAutoloader = getcwd() . '/vendor/autoload.php';

if (file_exists($internalAutoloader)) {
    require $internalAutoloader;
} elseif (file_exists($currentAutoloader)) {
    require $currentAutoloader;
} else {
    die("âŒ Error: No se encontrÃ³ 'vendor/autoload.php'.\n");
}

use Framework\Console\Commands\InitCommand;
use Framework\Console\Commands\ServeCommand;
use Framework\Console\Commands\MakeControllerCommand;

function displayHelp() {
    echo "\n";
    echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n";
    echo "â•‘    ðŸš€ Olyxis CLI v2.0 Stable           â•‘\n";
    echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n";
    echo "Comandos disponibles:\n";
    echo "  â”œâ”€ init             Inicializa un nuevo proyecto\n";
    echo "  â”œâ”€ serve            Inicia el servidor de desarrollo\n";
    echo "  â””â”€ make:controller  Crea un nuevo controlador\n\n";
    echo "Ejemplo: php olyxis make:controller User\n\n";
}

$command = $argv[1] ?? 'help';
$args = array_slice($argv, 2);

switch ($command) {
    case 'init':
        (new InitCommand())->execute($args);
        break;
    case 'serve':
        (new ServeCommand())->execute($args);
        break;
    case 'make:controller':
        (new MakeControllerCommand())->execute($args);
        break;
    case 'help':
    default:
        displayHelp(); 
        break;
}